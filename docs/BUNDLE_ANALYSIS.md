# S5.js Bundle Analysis Report

**Generated:** 2025-10-17T21:36:18.716Z

## Executive Summary

This report analyzes bundle sizes for different entry points of the S5.js library to ensure compliance with the grant requirement of ≤ 700KB compressed.

## Bundle Sizes

| Bundle | Raw | Gzip | Brotli | Status |
|--------|-----|------|--------|--------|
| Core | 214.72 KB | 71.75 KB | 59.61 KB | ✅ Pass |
| Media | 35.98 KB | 11.03 KB | 9.79 KB | ✅ Pass |
| Full | 217.15 KB | 72.37 KB | 60.09 KB | ✅ Pass |

## Tree-Shaking Analysis

The modular export structure enables consumers to import only what they need:

- **Core only:** 59.61 KB (excludes media processing)
- **Media only:** 9.79 KB (media processing modules)
- **Full bundle:** 60.09 KB (all features)
- **Combined (Core + Media):** 69.41 KB
- **Shared code savings:** 9.31 KB (13.4% efficiency)

## Detailed Breakdown

### Core

**Description:** File system operations without media processing

**Entry Point:** `dist/src/exports/core.js`

**Sizes:**
- Raw: 214.72 KB
- Gzipped: 71.75 KB (33.4% of raw)
- Brotli: 59.61 KB (27.8% of raw)

**Metadata:**
- Input files: 295
- Output modules: 1

### Media

**Description:** Media processing modules only

**Entry Point:** `dist/src/exports/media.js`

**Sizes:**
- Raw: 35.98 KB
- Gzipped: 11.03 KB (30.7% of raw)
- Brotli: 9.79 KB (27.2% of raw)

**Metadata:**
- Input files: 9
- Output modules: 1

### Full

**Description:** Complete SDK with all features

**Entry Point:** `dist/src/index.js`

**Sizes:**
- Raw: 217.15 KB
- Gzipped: 72.37 KB (33.3% of raw)
- Brotli: 60.09 KB (27.7% of raw)

**Metadata:**
- Input files: 295
- Output modules: 1

## Recommendations

✅ **Full bundle size is within the 700KB limit** (60.09 KB)

### For Application Developers:

1. **Use modular imports** to reduce bundle size:
   ```javascript
   // Import only what you need
   import { S5, FS5 } from 's5/core';  // Smaller bundle
   import { MediaProcessor } from 's5/media';  // Add media when needed
   ```

2. **Lazy-load media processing** for optimal initial load:
   ```javascript
   // Media modules use dynamic imports internally
   const media = await import('s5/media');
   await media.MediaProcessor.initialize();
   ```

3. **Tree-shaking is enabled** - modern bundlers will eliminate unused code automatically.

## Grant Compliance

**Requirement:** Bundle size ≤ 700KB compressed (brotli)

**Status:** ✅ **COMPLIANT**

- Full bundle (brotli): 60.09 KB
- Target: 700 KB
- Margin: 639.91 KB under budget

## Technical Implementation

### Code Splitting

The library uses a modular export structure with separate entry points:

1. **Main export** (`s5`): Full SDK with all features
2. **Core export** (`s5/core`): File system operations only
3. **Media export** (`s5/media`): Media processing with lazy loading

### Lazy Loading

Media processing modules use dynamic imports to enable code splitting:

- `MediaProcessorLazy` loads the actual implementation on first use
- WASM modules are loaded only when needed
- Canvas fallback loads separately from WASM

### Tree-Shaking

- Package.json includes `"sideEffects": false`
- ES modules with proper export structure
- Modern bundlers can eliminate unused code

### Build Configuration

- **Target:** ES2022
- **Format:** ESM (ES modules)
- **Minification:** Enabled
- **Source maps:** Available for debugging
- **TypeScript:** Declarations generated

---

*This report was automatically generated by `scripts/analyze-bundle.js`*
