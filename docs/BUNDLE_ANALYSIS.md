# S5.js Bundle Analysis Report

**Generated:** 2025-10-27T15:42:51.850Z

## Executive Summary

This report analyzes bundle sizes for different entry points of the S5.js library to ensure compliance with the grant requirement of ≤ 700KB compressed.

## Bundle Sizes

| Bundle | Raw | Gzip | Brotli | Status |
|--------|-----|------|--------|--------|
| Core | 214.78 KB | 71.77 KB | 59.58 KB | ✅ Pass |
| Media | 35.98 KB | 11.03 KB | 9.79 KB | ✅ Pass |
| Advanced | 218.69 KB | 72.90 KB | 60.60 KB | ✅ Pass |
| Full | 221.12 KB | 73.48 KB | 61.14 KB | ✅ Pass |

## Tree-Shaking Analysis

The modular export structure enables consumers to import only what they need:

- **Core only:** 59.58 KB (excludes media processing)
- **Media only:** 9.79 KB (media processing modules)
- **Full bundle:** 61.14 KB (all features)
- **Combined (Core + Media):** 69.37 KB
- **Shared code savings:** 8.23 KB (11.9% efficiency)

## Detailed Breakdown

### Core

**Description:** File system operations without media processing

**Entry Point:** `dist/src/exports/core.js`

**Sizes:**
- Raw: 214.78 KB
- Gzipped: 71.77 KB (33.4% of raw)
- Brotli: 59.58 KB (27.7% of raw)

**Metadata:**
- Input files: 295
- Output modules: 1

### Media

**Description:** Media processing modules only

**Entry Point:** `dist/src/exports/media.js`

**Sizes:**
- Raw: 35.98 KB
- Gzipped: 11.03 KB (30.7% of raw)
- Brotli: 9.79 KB (27.2% of raw)

**Metadata:**
- Input files: 9
- Output modules: 1

### Advanced

**Description:** Advanced CID-aware API with core functionality

**Entry Point:** `dist/src/exports/advanced.js`

**Sizes:**
- Raw: 218.69 KB
- Gzipped: 72.90 KB (33.3% of raw)
- Brotli: 60.60 KB (27.7% of raw)

**Metadata:**
- Input files: 298
- Output modules: 1

### Full

**Description:** Complete SDK with all features

**Entry Point:** `dist/src/index.js`

**Sizes:**
- Raw: 221.12 KB
- Gzipped: 73.48 KB (33.2% of raw)
- Brotli: 61.14 KB (27.6% of raw)

**Metadata:**
- Input files: 297
- Output modules: 1

## Recommendations

✅ **Full bundle size is within the 700KB limit** (61.14 KB)

### For Application Developers:

1. **Use modular imports** to reduce bundle size:
   ```javascript
   // Import only what you need
   import { S5, FS5 } from 's5/core';  // Smaller bundle
   import { MediaProcessor } from 's5/media';  // Add media when needed
   ```

2. **Lazy-load media processing** for optimal initial load:
   ```javascript
   // Media modules use dynamic imports internally
   const media = await import('s5/media');
   await media.MediaProcessor.initialize();
   ```

3. **Tree-shaking is enabled** - modern bundlers will eliminate unused code automatically.

## Grant Compliance

**Requirement:** Bundle size ≤ 700KB compressed (brotli)

**Status:** ✅ **COMPLIANT**

- Full bundle (brotli): 61.14 KB
- Target: 700 KB
- Margin: 638.86 KB under budget

## Technical Implementation

### Code Splitting

The library uses a modular export structure with separate entry points:

1. **Main export** (`s5`): Full SDK with all features
2. **Core export** (`s5/core`): File system operations only
3. **Media export** (`s5/media`): Media processing with lazy loading
4. **Advanced export** (`s5/advanced`): CID-aware API for power users

### Lazy Loading

Media processing modules use dynamic imports to enable code splitting:

- `MediaProcessorLazy` loads the actual implementation on first use
- WASM modules are loaded only when needed
- Canvas fallback loads separately from WASM

### Tree-Shaking

- Package.json includes `"sideEffects": false`
- ES modules with proper export structure
- Modern bundlers can eliminate unused code

### Build Configuration

- **Target:** ES2022
- **Format:** ESM (ES modules)
- **Minification:** Enabled
- **Source maps:** Available for debugging
- **TypeScript:** Declarations generated

---

*This report was automatically generated by `scripts/analyze-bundle.js`*
